(self.webpackChunkauthform=self.webpackChunkauthform||[]).push([[665],{6307:(e,r,l)=>{"use strict";l.r(r),l.d(r,{default:()=>w});var n=l(5522),t=l(9838),s=l(5043),a=l(1476),o=l(6593),i=l.n(o),c=l(8606),d=l(8028),u=l(3952),h=l(5695),f=l(9627),x=l(3734),m=l(9058),j=l(2285),g=l.n(j),v=l(579);function p(){const e=(0,c.Y)(),[r,l]=(0,s.useState)(""),[t,o]=(0,s.useState)(null),[j,g]=(0,s.useState)(!1),[p,w]=(0,s.useState)(""),[y,b]=(0,s.useState)(null),[k,S]=(0,s.useState)(!1),[C,E]=(0,s.useState)(""),[z,I]=(0,s.useState)(!1),[D,N]=(0,s.useState)(""),R=(0,s.useRef)(null),T=(0,s.useRef)(null),A=(0,s.useRef)(null);(0,s.useEffect)((()=>(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((e=>{o(e),R.current&&(R.current.srcObject=e)})).catch((e=>console.error("Error accessing media devices.",e))),e.on("me",(e=>{console.log("me ID",e),l(e)})),e.on("callUser",(e=>{g(!0),w(e.from),b(e.signal)})),()=>{e.off("me"),e.off("callUser")})),[e]),(0,s.useEffect)((()=>{console.log("0"),t&&R.current&&(console.log("1"),R.current.srcObject=t),console.log("2"),l(e.id)}),[t,e.id,e]);return(0,s.useEffect)((()=>()=>{A.current&&A.current.destroy(),t&&t.getTracks().forEach((e=>e.stop()))}),[t]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("h1",{style:{textAlign:"center",color:"#fff"},children:"Zoomish"}),(0,v.jsxs)("div",{className:"container",children:[(0,v.jsxs)("div",{className:"video-container",children:[k&&(0,v.jsx)(n.az,{h:"136px",w:"136px",rounded:"full",position:"relative",flexShrink:0,children:(0,v.jsx)(n.az,{overflow:"hidden",h:"100%",w:"100%",rounded:"full",children:(0,v.jsx)("video",{playsInline:!0,ref:T,autoPlay:!0,style:{maxWidth:"100%",objectFit:"cover",borderRadius:"50%",transform:"translate3d(0, 0, 0)",width:"136px",height:"136px"}})})}),t&&(0,v.jsx)(n.az,{h:"136px",w:"136px",rounded:"full",position:"relative",flexShrink:0,overflow:"hidden",children:(0,v.jsx)(n.az,{overflow:"hidden",h:"100%",w:"100%",rounded:"full",children:(0,v.jsx)("video",{playsInline:!0,muted:!0,ref:R,autoPlay:!0,style:{maxWidth:"100%",objectFit:"cover",borderRadius:"50%",transform:"translate3d(0, 0, 0)",width:"136px",height:"136px"}})})})]}),(0,v.jsxs)("div",{className:"myId",children:[(0,v.jsxs)(n.az,{children:[(0,v.jsx)(a.CopyToClipboard,{text:r,style:{marginBottom:"2rem"},children:(0,v.jsx)(d.$,{variant:"contained",color:"primary",startIcon:(0,v.jsx)(x.X,{fontSize:"large"}),children:"Copy ID"})}),(0,v.jsx)(u.E,{children:r})]}),(0,v.jsx)(h.T,{style:{width:"20rem"},id:"filled-basic",label:"ID to call",variant:"filled",value:C,onChange:e=>E(e.target.value)}),(0,v.jsx)("div",{className:"call-button",children:k&&!z?(0,v.jsx)(d.$,{variant:"contained",color:"secondary",onClick:()=>{I(!0),A.current&&A.current.destroy(),t&&t.getTracks().forEach((e=>e.stop())),g(!1),w(""),b(null),S(!1)},children:"End Call"}):(0,v.jsx)(f.K,{color:"primary","aria-label":"call",onClick:()=>(l=>{const n=new(i())({initiator:!0,trickle:!1,stream:t});n.on("signal",(n=>{e.emit("callUser",{userToCall:l,signalData:n,from:r,name:D})})),n.on("stream",(e=>{T.current.srcObject=e})),n.on("error",(e=>console.error("Peer error:",e))),e.on("callAccepted",(e=>{S(!0),n.signal(e)})),A.current=n})(C),children:(0,v.jsx)(m.E,{fontSize:"large"})})})]}),(0,v.jsx)("div",{children:j&&!k?(0,v.jsxs)("div",{className:"caller",children:[(0,v.jsxs)("h1",{children:[D," is calling..."]}),(0,v.jsx)(d.$,{variant:"contained",color:"primary",onClick:()=>{S(!0);const r=new(i())({initiator:!1,trickle:!1,stream:t});r.on("signal",(r=>{e.emit("answerCall",{signal:r,to:p})})),r.on("stream",(e=>{T.current&&(T.current.srcObject=e)})),r.on("error",(e=>console.error("Peer error:",e))),r.signal(y),A.current=r},children:"Answer"})]}):null})]})]})}function w(){return(0,v.jsx)(t.A,{children:(0,v.jsx)(n.az,{bg:"white",children:(0,v.jsx)(p,{})})})}window.process=g()},5340:()=>{},7457:()=>{}}]);
//# sourceMappingURL=665.bc5d5d8c.chunk.js.map