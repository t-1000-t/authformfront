(self.webpackChunkauthform=self.webpackChunkauthform||[]).push([[606],{8493:(e,r,l)=>{"use strict";l.r(r),l.d(r,{default:()=>b});var n=l(824),t=l(5212),o=l(2791),s=l(4162),a=l(9611),i=l(6513),c=l(7025),d=l(1159),u=l(4600),h=l(8029),f=l(7532),x=l.n(f),m=l(6253),j=l(884),g=l(1426),v=l.n(g),p=l(184);function y(){const e=(0,m.s)(),[r,l]=(0,o.useState)(""),[n,t]=(0,o.useState)(null),[f,g]=(0,o.useState)(!1),[v,y]=(0,o.useState)(""),[b,w]=(0,o.useState)(null),[Z,k]=(0,o.useState)(!1),[C,S]=(0,o.useState)(""),[E,I]=(0,o.useState)(!1),[N,D]=(0,o.useState)(""),R=(0,o.useRef)(null),O=(0,o.useRef)(null),P=(0,o.useRef)(null);(0,o.useEffect)((()=>(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((e=>{t(e),R.current&&(R.current.srcObject=e)})).catch((e=>console.error("Error accessing media devices.",e))),e.on("me",(e=>{console.log("me ID",e),l(e)})),e.on("callUser",(e=>{g(!0),y(e.from),w(e.signal)})),()=>{e.off("me"),e.off("callUser")})),[e]),(0,o.useEffect)((()=>{console.log("0"),n&&R.current&&(console.log("1"),R.current.srcObject=n),console.log("2"),l(e.id)}),[n,e.id,e]);return(0,o.useEffect)((()=>()=>{P.current&&P.current.destroy(),n&&n.getTracks().forEach((e=>e.stop()))}),[n]),console.log("myVideo.current",R.current),console.log("opponentVideo.current",O.current),console.log("stream",n),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h1",{style:{textAlign:"center",color:"#fff"},children:"Zoomish"}),(0,p.jsxs)("div",{className:"container",children:[(0,p.jsxs)("div",{className:"video-container",children:[Z&&(0,p.jsx)(s.Z,{h:"136px",w:"136px",rounded:"full",position:"relative",flexShrink:0,children:(0,p.jsx)(s.Z,{overflow:"hidden",h:"100%",w:"100%",rounded:"full",children:(0,p.jsx)("video",{playsInline:!0,ref:O,autoPlay:!0,style:{maxWidth:"100%",objectFit:"cover",borderRadius:"50%",transform:"translate3d(0, 0, 0)",width:"136px",height:"136px"}})})}),n&&(0,p.jsx)(s.Z,{h:"136px",w:"136px",rounded:"full",position:"relative",flexShrink:0,overflow:"hidden",children:(0,p.jsx)(s.Z,{overflow:"hidden",h:"100%",w:"100%",rounded:"full",children:(0,p.jsx)("video",{playsInline:!0,muted:!0,ref:R,autoPlay:!0,style:{maxWidth:"100%",objectFit:"cover",borderRadius:"50%",transform:"translate3d(0, 0, 0)",width:"136px",height:"136px"}})})})]}),(0,p.jsxs)("div",{className:"myId",children:[(0,p.jsx)(a.Z,{id:"filled-basic",label:"Name",variant:"filled",value:N,onChange:e=>D(e.target.value),style:{marginBottom:"20px"}}),(0,p.jsxs)(s.Z,{children:[(0,p.jsx)(h.CopyToClipboard,{text:r,style:{marginBottom:"2rem"},children:(0,p.jsx)(i.Z,{variant:"contained",color:"primary",startIcon:(0,p.jsx)(d.Z,{fontSize:"large"}),children:"Copy ID"})}),(0,p.jsx)(j.x,{children:r})]}),(0,p.jsx)(a.Z,{id:"filled-basic",label:"ID to call",variant:"filled",value:C,onChange:e=>S(e.target.value)}),(0,p.jsx)("div",{className:"call-button",children:Z&&!E?(0,p.jsx)(i.Z,{variant:"contained",color:"secondary",onClick:()=>{I(!0),P.current&&P.current.destroy(),n&&n.getTracks().forEach((e=>e.stop())),g(!1),y(""),w(null),k(!1)},children:"End Call"}):(0,p.jsx)(c.Z,{color:"primary","aria-label":"call",onClick:()=>(l=>{const t=new(x())({initiator:!0,trickle:!1,stream:n});t.on("signal",(n=>{e.emit("callUser",{userToCall:l,signalData:n,from:r,name:N})})),t.on("stream",(e=>{O.current.srcObject=e})),t.on("error",(e=>console.error("Peer error:",e))),e.on("callAccepted",(e=>{k(!0),t.signal(e)})),P.current=t})(C),children:(0,p.jsx)(u.Z,{fontSize:"large"})})})]}),(0,p.jsx)("div",{children:f&&!Z?(0,p.jsxs)("div",{className:"caller",children:[(0,p.jsxs)("h1",{children:[N," is calling..."]}),(0,p.jsx)(i.Z,{variant:"contained",color:"primary",onClick:()=>{k(!0);const r=new(x())({initiator:!1,trickle:!1,stream:n});r.on("signal",(r=>{e.emit("answerCall",{signal:r,to:v})})),r.on("stream",(e=>{O.current&&(O.current.srcObject=e)})),r.on("error",(e=>console.error("Peer error:",e))),r.signal(b),P.current=r},children:"Answer"})]}):null})]})]})}function b(){return(0,p.jsx)(t.Z,{children:(0,p.jsx)(n.xu,{bg:"white",children:(0,p.jsx)(y,{})})})}window.process=v()},2361:()=>{},4616:()=>{}}]);
//# sourceMappingURL=606.cc9bf2a4.chunk.js.map